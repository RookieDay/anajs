<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title></title>
		<script>
			// 构造函数
			var itcast = function ( selector ) {
				return new itcast.fn.init( selector );
			};
			// 核心原型
			itcast.fn = itcast.prototype = {
				constructor: itcast,
				selector: null,
				init: function ( selector ) {
					// 字符串: 选择器, html
					if ( typeof selector == 'string' ) {
						if ( selector.charAt( 0 ) === '<' ) {
							this.elements = parseHTML( selector );
						} else {
							this.elements = select( selector );
						}
					}
					this.selector = selector;
				}
			};
			itcast.fn.init.prototype = itcast.prototype;
			
			// 可扩展
			itcast.extend = itcast.fn.extend = function ( obj ) {
				// 将 obj 的成员加到 this 上
				var k;
				for ( k in obj ) {
					this[ k ] = obj[ k ];
				}
			};
			
			var select = function ( selector ) {
				var first = selector.charAt( 0 ), arr = [];
				if ( first === '#' ) {
					arr.push.call( arr, document.getElementById( selector.slice( 1 ) ) )
				} else if ( first === '.' ) {
					arr.push.apply( arr, document.getElementsByClassName( selector.slice( 1 ) ) )
				} else {
					arr.push.apply( arr, document.getElementsByTagName( selector ) );
				}
				return arr;
			};
			
			var parseHTML = function ( html ) {
				var div = document.createElement( 'div' ),
					arr = [], i;
				div.innerHTML = html;
				for ( i = 0; i < div.childNodes.length; i++ ) {
					arr.push( div.childNodes[ i ] );
				}
				return arr;
			};
			
			// 基本的工具方法
			itcast.extend({
				each: function ( arr, fn ) {
					var i, l = arr.length, 
						isArray = itcast.isLikeArray( arr );
					if ( isArray ) {
						// 数组
						for ( i = 0; i < l; i++ ) {
							if ( fn.call( arr[ i ], i, arr[ i ] ) === false ) {
								break;
							}
						}
					} else {
						// 对象
						for ( i in arr ) {
							if ( fn.call( arr[ i ], i, arr[ i ] ) === false ) {
								break;
							}
						}
					}
					return arr;
				}
			});
			
			// 判断类型的方法
			itcast.extend({
				isFunction: function ( obj ) {
					return typeof obj === 'function';
				},
				isString: function ( obj ) {
					return typeof obj === 'string';
				},
				isLikeArray: function ( obj ) {
					return obj && obj.length && obj.length >= 0;
				},
				isItcast: function ( obj ) {
					return !!obj.selector;
				},
				isDOM: function ( obj ) {
					return !!obj.nodeType;
				}
			});
			
			
			// 基本的 DOM 操作
			itcast.fn.extend({
				appendTo: function ( selector ) {
					// 将 this.elements 加入到 selector 中
					itcast.each( this.elements, function () {
						selector.appendChild( this );
					} );
				}
			});
			
			
		</script>
		
		<script type="text/javascript">
			onload = function () {
				itcast( '<div>1</div><div>2</div><div>3</div><div>4</div>' )
					.appendTo( document.body );
			}
		</script>
	</head>
	<body>
	</body>
</html>
